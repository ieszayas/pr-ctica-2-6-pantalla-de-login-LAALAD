/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JFrame.java to edit this template
 */
package VistaControlador;

import IO.IniciarBBDD;
import IO.UsuarioDAO;
import Modelo.Login;
import Modelo.Usuario;
import java.awt.Color;
import javax.swing.BorderFactory;
import javax.swing.JOptionPane;
import javax.swing.border.Border;

/**
 *
 * @author adria
 */
public class Ventana_practica2_6 extends javax.swing.JFrame {

    /**
     * Creates new form Ventana_practica2_6
     */
    Login login = new Login();
    Border original;

    public Ventana_practica2_6() {
        initComponents();
        IniciarBBDD.crearBBDD();
        msg_incorrecta.setVisible(false);
        original = caja_username.getBorder();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        ventana_log_correcto = new javax.swing.JFrame();
        jPanel1 = new javax.swing.JPanel();
        bienvenido = new javax.swing.JLabel();
        msg_bienvenida = new javax.swing.JLabel();
        icono = new javax.swing.JLabel();
        cerrar_sesion = new javax.swing.JButton();
        boton_nuevo_usuario_log = new javax.swing.JButton();
        modificar_password = new javax.swing.JButton();
        ventana_crear_usuario = new javax.swing.JFrame();
        jPanel2 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        etiqueta_usuario = new javax.swing.JLabel();
        etiqueta_contrasena_crear_usuario = new javax.swing.JLabel();
        etiqueta_contrasena_crear_usuario2 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        jSeparator1 = new javax.swing.JSeparator();
        etiqueta_nombre = new javax.swing.JLabel();
        etiqueta_apellido = new javax.swing.JLabel();
        etiqueta_fecha_nac = new javax.swing.JLabel();
        etiqueta_correo = new javax.swing.JLabel();
        boton_volver = new javax.swing.JButton();
        boton_agregar = new javax.swing.JButton();
        caja_username_crear = new javax.swing.JTextField();
        caja_contrasena_crear = new javax.swing.JTextField();
        caja_contrasena_crear_2 = new javax.swing.JTextField();
        caja_nombre = new javax.swing.JTextField();
        caja_apellido = new javax.swing.JTextField();
        caja_fecha_nac = new javax.swing.JTextField();
        caja_correo = new javax.swing.JTextField();
        calendario = new com.toedter.calendar.JDateChooser();
        ventana_cambiar_password = new javax.swing.JFrame();
        jPanel3 = new javax.swing.JPanel();
        caja_antigua = new javax.swing.JPasswordField();
        texto_password = new javax.swing.JLabel();
        etiqueta_antigua = new javax.swing.JLabel();
        etiqueta_nueva = new javax.swing.JLabel();
        etiqueta_confirmar = new javax.swing.JLabel();
        caja_nueva = new javax.swing.JPasswordField();
        caja_confirmar = new javax.swing.JPasswordField();
        actualizar_password = new javax.swing.JButton();
        panel_loggin = new javax.swing.JPanel();
        etiqueta_instrucciones = new javax.swing.JLabel();
        eiqueta_usuario = new javax.swing.JLabel();
        etiqueta_contrasena = new javax.swing.JLabel();
        caja_username = new javax.swing.JTextField();
        caja_password = new javax.swing.JPasswordField();
        opcion_mostrar = new javax.swing.JCheckBox();
        boton_loggear = new javax.swing.JButton();
        msg_incorrecta = new javax.swing.JLabel();
        crear_cuenta = new javax.swing.JLabel();

        ventana_log_correcto.setTitle("Principal");

        jPanel1.setPreferredSize(new java.awt.Dimension(330, 330));

        bienvenido.setFont(new java.awt.Font("Segoe UI", 1, 36)); // NOI18N
        bienvenido.setText("Bienvenido");

        msg_bienvenida.setText("msg usuario");

        icono.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Media/imagen.png"))); // NOI18N

        cerrar_sesion.setText("Cerrar sesión");
        cerrar_sesion.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cerrar_sesionActionPerformed(evt);
            }
        });

        boton_nuevo_usuario_log.setText("Nuevo usuario");
        boton_nuevo_usuario_log.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                boton_nuevo_usuario_logActionPerformed(evt);
            }
        });

        modificar_password.setText("Cambiar contraseña");
        modificar_password.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                modificar_passwordActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(26, 26, 26)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(cerrar_sesion, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(bienvenido, javax.swing.GroupLayout.DEFAULT_SIZE, 193, Short.MAX_VALUE)
                    .addComponent(msg_bienvenida, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(boton_nuevo_usuario_log, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(modificar_password, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap(18, Short.MAX_VALUE))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(icono)
                .addGap(64, 64, 64))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
                .addGap(29, 29, 29)
                .addComponent(bienvenido)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(icono)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(msg_bienvenida, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(modificar_password)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(boton_nuevo_usuario_log)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(cerrar_sesion)
                .addGap(35, 35, 35))
        );

        javax.swing.GroupLayout ventana_log_correctoLayout = new javax.swing.GroupLayout(ventana_log_correcto.getContentPane());
        ventana_log_correcto.getContentPane().setLayout(ventana_log_correctoLayout);
        ventana_log_correctoLayout.setHorizontalGroup(
            ventana_log_correctoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(ventana_log_correctoLayout.createSequentialGroup()
                .addGap(24, 24, 24)
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, 237, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(20, Short.MAX_VALUE))
        );
        ventana_log_correctoLayout.setVerticalGroup(
            ventana_log_correctoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(ventana_log_correctoLayout.createSequentialGroup()
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, 364, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );

        ventana_crear_usuario.setTitle("Agregar nuevo usuario");

        jLabel1.setText("Por favor, introduzca la información del nuevo usuario:");

        etiqueta_usuario.setText("Usuario");

        etiqueta_contrasena_crear_usuario.setText("Contraseña");

        etiqueta_contrasena_crear_usuario2.setText("Confirmar contraseña");

        jLabel5.setText("Agregar datos opcionales del nuevo usuario:");

        etiqueta_nombre.setText("Nombre");

        etiqueta_apellido.setText("Apellido");

        etiqueta_fecha_nac.setText("Fecha nacimiento");

        etiqueta_correo.setText("Correo");

        boton_volver.setText("Volver");
        boton_volver.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                boton_volverActionPerformed(evt);
            }
        });

        boton_agregar.setText("Agregar");
        boton_agregar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                boton_agregarActionPerformed(evt);
            }
        });

        caja_correo.setForeground(new java.awt.Color(153, 153, 153));
        caja_correo.setText("p.ej: ejemplo@ejemplo.com");
        caja_correo.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                caja_correoMousePressed(evt);
            }
        });

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jSeparator1)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(jLabel1)
                            .addComponent(jLabel5)
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(etiqueta_contrasena_crear_usuario2)
                                    .addComponent(etiqueta_contrasena_crear_usuario, javax.swing.GroupLayout.Alignment.TRAILING)
                                    .addComponent(etiqueta_usuario, javax.swing.GroupLayout.Alignment.TRAILING))
                                .addGap(24, 24, 24)
                                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(caja_contrasena_crear_2)
                                    .addComponent(caja_username_crear)
                                    .addComponent(caja_contrasena_crear)))
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addGap(10, 10, 10)
                                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                    .addComponent(etiqueta_correo)
                                    .addComponent(etiqueta_apellido)
                                    .addComponent(etiqueta_fecha_nac)
                                    .addComponent(etiqueta_nombre))
                                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addGroup(jPanel2Layout.createSequentialGroup()
                                        .addGap(3, 3, 3)
                                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                            .addComponent(caja_nombre, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 163, javax.swing.GroupLayout.PREFERRED_SIZE)
                                            .addGroup(jPanel2Layout.createSequentialGroup()
                                                .addGap(18, 18, 18)
                                                .addComponent(caja_fecha_nac)
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                .addComponent(calendario, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))))
                                    .addGroup(jPanel2Layout.createSequentialGroup()
                                        .addGap(21, 21, 21)
                                        .addComponent(caja_apellido))
                                    .addGroup(jPanel2Layout.createSequentialGroup()
                                        .addGap(22, 22, 22)
                                        .addComponent(caja_correo))))))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGap(53, 53, 53)
                        .addComponent(boton_volver)
                        .addGap(89, 89, 89)
                        .addComponent(boton_agregar)))
                .addContainerGap(35, Short.MAX_VALUE))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel1)
                .addGap(18, 18, 18)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(etiqueta_usuario)
                    .addComponent(caja_username_crear, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(etiqueta_contrasena_crear_usuario)
                    .addComponent(caja_contrasena_crear, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(etiqueta_contrasena_crear_usuario2)
                    .addComponent(caja_contrasena_crear_2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addComponent(jSeparator1, javax.swing.GroupLayout.PREFERRED_SIZE, 10, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel5)
                .addGap(18, 18, 18)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(etiqueta_nombre)
                    .addComponent(caja_nombre, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(etiqueta_apellido)
                    .addComponent(caja_apellido, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(etiqueta_fecha_nac)
                        .addComponent(caja_fecha_nac, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(calendario, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(etiqueta_correo)
                    .addComponent(caja_correo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 32, Short.MAX_VALUE)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(boton_volver)
                    .addComponent(boton_agregar))
                .addContainerGap())
        );

        javax.swing.GroupLayout ventana_crear_usuarioLayout = new javax.swing.GroupLayout(ventana_crear_usuario.getContentPane());
        ventana_crear_usuario.getContentPane().setLayout(ventana_crear_usuarioLayout);
        ventana_crear_usuarioLayout.setHorizontalGroup(
            ventana_crear_usuarioLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, ventana_crear_usuarioLayout.createSequentialGroup()
                .addContainerGap(31, Short.MAX_VALUE)
                .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );
        ventana_crear_usuarioLayout.setVerticalGroup(
            ventana_crear_usuarioLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(ventana_crear_usuarioLayout.createSequentialGroup()
                .addGap(17, 17, 17)
                .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        texto_password.setText("Texto password");

        etiqueta_antigua.setText("Contraseña antigua");

        etiqueta_nueva.setText("Contraseña nueva");

        etiqueta_confirmar.setText("Confirme contraseña");

        caja_nueva.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                caja_nuevaMousePressed(evt);
            }
        });
        caja_nueva.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                caja_nuevaActionPerformed(evt);
            }
        });

        caja_confirmar.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                caja_confirmarMousePressed(evt);
            }
        });

        actualizar_password.setText("Actualizar");
        actualizar_password.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                actualizar_passwordActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addComponent(texto_password)
                        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                .addComponent(etiqueta_confirmar)
                                .addComponent(etiqueta_nueva))
                            .addGroup(jPanel3Layout.createSequentialGroup()
                                .addGap(8, 8, 8)
                                .addComponent(etiqueta_antigua)))
                        .addGap(29, 29, 29)
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel3Layout.createSequentialGroup()
                                .addComponent(caja_antigua, javax.swing.GroupLayout.PREFERRED_SIZE, 112, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                            .addGroup(jPanel3Layout.createSequentialGroup()
                                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(caja_nueva, javax.swing.GroupLayout.PREFERRED_SIZE, 112, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(caja_confirmar, javax.swing.GroupLayout.PREFERRED_SIZE, 112, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(0, 20, Short.MAX_VALUE))))))
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addGap(89, 89, 89)
                .addComponent(actualizar_password)
                .addGap(0, 0, Short.MAX_VALUE))
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addGap(14, 14, 14)
                .addComponent(texto_password)
                .addGap(32, 32, 32)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(caja_antigua, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(etiqueta_antigua))
                .addGap(18, 18, 18)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(etiqueta_nueva)
                    .addComponent(caja_nueva, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(etiqueta_confirmar)
                    .addComponent(caja_confirmar, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(34, 34, 34)
                .addComponent(actualizar_password)
                .addContainerGap(42, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout ventana_cambiar_passwordLayout = new javax.swing.GroupLayout(ventana_cambiar_password.getContentPane());
        ventana_cambiar_password.getContentPane().setLayout(ventana_cambiar_passwordLayout);
        ventana_cambiar_passwordLayout.setHorizontalGroup(
            ventana_cambiar_passwordLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(ventana_cambiar_passwordLayout.createSequentialGroup()
                .addGap(20, 20, 20)
                .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        ventana_cambiar_passwordLayout.setVerticalGroup(
            ventana_cambiar_passwordLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(ventana_cambiar_passwordLayout.createSequentialGroup()
                .addGap(20, 20, 20)
                .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(17, Short.MAX_VALUE))
        );

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("Login");
        setResizable(false);

        etiqueta_instrucciones.setText("Por favor, introdzca sus credenciales para acceder.");

        eiqueta_usuario.setText("Usuario");

        etiqueta_contrasena.setText("Contraseña");

        caja_username.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                caja_usernameMousePressed(evt);
            }
        });

        opcion_mostrar.setText("Mostrar");
        opcion_mostrar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                opcion_mostrarActionPerformed(evt);
            }
        });

        boton_loggear.setText("Loggear");
        boton_loggear.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                boton_loggearActionPerformed(evt);
            }
        });

        msg_incorrecta.setFont(new java.awt.Font("Segoe UI", 0, 10)); // NOI18N
        msg_incorrecta.setForeground(new java.awt.Color(255, 0, 0));
        msg_incorrecta.setText("Usuario o contraseña incorerctos");

        crear_cuenta.setForeground(new java.awt.Color(0, 102, 204));
        crear_cuenta.setText("Haz clic para crear una cuenta nueva");
        crear_cuenta.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                crear_cuentaMousePressed(evt);
            }
        });

        javax.swing.GroupLayout panel_logginLayout = new javax.swing.GroupLayout(panel_loggin);
        panel_loggin.setLayout(panel_logginLayout);
        panel_logginLayout.setHorizontalGroup(
            panel_logginLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panel_logginLayout.createSequentialGroup()
                .addGroup(panel_logginLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(panel_logginLayout.createSequentialGroup()
                        .addGap(52, 52, 52)
                        .addGroup(panel_logginLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(etiqueta_instrucciones)
                            .addGroup(panel_logginLayout.createSequentialGroup()
                                .addGroup(panel_logginLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                    .addComponent(crear_cuenta)
                                    .addGroup(panel_logginLayout.createSequentialGroup()
                                        .addGroup(panel_logginLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                            .addComponent(eiqueta_usuario)
                                            .addComponent(etiqueta_contrasena))
                                        .addGap(18, 18, 18)
                                        .addGroup(panel_logginLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                                            .addComponent(caja_password, javax.swing.GroupLayout.DEFAULT_SIZE, 173, Short.MAX_VALUE)
                                            .addComponent(caja_username))))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(opcion_mostrar))))
                    .addGroup(panel_logginLayout.createSequentialGroup()
                        .addGap(166, 166, 166)
                        .addComponent(boton_loggear)))
                .addContainerGap(54, Short.MAX_VALUE))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, panel_logginLayout.createSequentialGroup()
                .addGap(0, 0, Short.MAX_VALUE)
                .addComponent(msg_incorrecta)
                .addGap(142, 142, 142))
        );
        panel_logginLayout.setVerticalGroup(
            panel_logginLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panel_logginLayout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(etiqueta_instrucciones)
                .addGap(30, 30, 30)
                .addGroup(panel_logginLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(caja_username, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(eiqueta_usuario))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(panel_logginLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(opcion_mostrar)
                    .addComponent(caja_password, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(etiqueta_contrasena))
                .addGap(27, 27, 27)
                .addComponent(msg_incorrecta)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(boton_loggear, javax.swing.GroupLayout.PREFERRED_SIZE, 23, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(crear_cuenta)
                .addGap(26, 26, 26))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(panel_loggin, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(30, 30, 30)
                .addComponent(panel_loggin, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGap(28, 28, 28))
        );

        pack();
        setLocationRelativeTo(null);
    }// </editor-fold>//GEN-END:initComponents

    private void opcion_mostrarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_opcion_mostrarActionPerformed
        if (opcion_mostrar.isSelected()) {
            caja_password.setEchoChar((char) 0);
        } else {
            caja_password.setEchoChar('*');
        }
    }//GEN-LAST:event_opcion_mostrarActionPerformed

    private void boton_loggearActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_boton_loggearActionPerformed
        String username = caja_username.getText();
        String password = String.valueOf(caja_password.getPassword());
        Boolean credenciales_correctas = login.comprobarUsuario(username, password);
        if (credenciales_correctas) {
            mostrarVentanaLogeo(username);
        } else {
            vibrar();
            avisoCredencialesIncorrectas();
        }
    }//GEN-LAST:event_boton_loggearActionPerformed

    public void mostrarVentanaLogeo(String usuario) {
        ventana_log_correcto.setSize(330, 400);
        msg_bienvenida.setText("El usuario " + usuario + " está logueado");
        ventana_log_correcto.setLocationRelativeTo(this);
        ventana_log_correcto.setVisible(true);
    }

    public void vibrar() {
        final int originalX = this.getLocationOnScreen().x;  // Obtener la posición original en X
        final int originalY = this.getLocationOnScreen().y;  // Obtener la posición original en Y

        // Creamos un hilo para que no bloquee el hilo principal de la UI
        new Thread(() -> {
            try {
                for (int i = 0; i < 10; i++) {
                    // Mover la ventana a posiciones levemente distintas
                    this.setLocation(originalX + (int) (Math.random() * 10 - 5),
                            originalY + (int) (Math.random() * 10 - 5));
                    Thread.sleep(20);  // Pausa breve entre cada movimiento
                }
                // Volver a la posición original al finalizar
                this.setLocation(originalX, originalY);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }).start();
    }

    //para conectar la otra ventana se pone nombreventana.setVisible(true);
    public void avisoCredencialesIncorrectas() {
        msg_incorrecta.setVisible(true);
//        Border rojo = new Border(Color.RED);
        Border bordeRojo = BorderFactory.createLineBorder(Color.RED, 2);
        caja_username.setBorder(bordeRojo);
        caja_password.setBorder(bordeRojo);
    }

    public void resetearLogin() {
        msg_incorrecta.setVisible(false);
        caja_username.setText("");
        caja_password.setText("");
        caja_username.setBorder(original);
        caja_password.setBorder(original);
    }

    public void resetearAgregar() {
        caja_username_crear.setText("");
        caja_contrasena_crear.setText("");
        caja_contrasena_crear_2.setText("");
        caja_nombre.setText("");
        caja_apellido.setText("");
        caja_fecha_nac.setText("");
        caja_correo.setText("p.ej: ejemplo@ejemplo.com");
    }

    private void caja_usernameMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_caja_usernameMousePressed
        resetearLogin();
    }//GEN-LAST:event_caja_usernameMousePressed

    private void cerrar_sesionActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cerrar_sesionActionPerformed
        ventana_log_correcto.setVisible(false);
        resetearLogin();
    }//GEN-LAST:event_cerrar_sesionActionPerformed

    private void crear_cuentaMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_crear_cuentaMousePressed
        mostrarVentanaCrearUsuario();
    }//GEN-LAST:event_crear_cuentaMousePressed

    private void boton_volverActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_boton_volverActionPerformed
        ventana_crear_usuario.setVisible(false);
    }//GEN-LAST:event_boton_volverActionPerformed

    private void boton_nuevo_usuario_logActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_boton_nuevo_usuario_logActionPerformed
        mostrarVentanaCrearUsuario();
    }//GEN-LAST:event_boton_nuevo_usuario_logActionPerformed

    private void mostrarVentanaCrearUsuario() {
        ventana_crear_usuario.setSize(400, 550);
        ventana_crear_usuario.setLocationRelativeTo(this);
        ventana_crear_usuario.setVisible(true);
    }

    private void boton_agregarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_boton_agregarActionPerformed
        String username = caja_username_crear.getText();
        String contrasena = caja_contrasena_crear.getText();
        String contrasena_confirmacion = caja_contrasena_crear_2.getText();

        if (username.isBlank() || contrasena.isBlank() || contrasena_confirmacion.isBlank()) {
            JOptionPane.showMessageDialog(null, "Por favor, rellene todos los campos obligtorios.", "Campos Obligatorios", JOptionPane.WARNING_MESSAGE);
            return;
        }

        if (login.comprobarUsername(username)) {
            //caja_username_crear.setBackground(Color.red);
            JOptionPane.showMessageDialog(null, "El nombre de usuario " + username + " ya está registrado", "Usuario existente", JOptionPane.WARNING_MESSAGE);
            caja_username_crear.setText("");
            return;
        }

        if (!contrasena.equals(contrasena_confirmacion)) {
            JOptionPane.showMessageDialog(null, "Las contraseñas introducidas no coinciden", "Contraseña no coincide", JOptionPane.WARNING_MESSAGE);
            caja_contrasena_crear.setText("");
            caja_contrasena_crear_2.setText("");
            return;
        }
        if (caja_correo.getText().equals("p.ej: ejemplo@ejemplo.com")) {
            caja_correo.setText("");
        }

        if (!caja_correo.getText().isBlank()) {
            if (!login.validarCorreo(caja_correo.getText())) {
                JOptionPane.showMessageDialog(null, "Introduzca un correo válido", "Correo no válido ", JOptionPane.WARNING_MESSAGE);
                caja_correo.setText("");
                return;
            }
        }

        Usuario nuevo = new Usuario(username, contrasena);
        nuevo.setNombre(caja_nombre.getText());
        nuevo.setApellido(caja_apellido.getText());
//        Dateformat df 
//        fecha = calendario.getDate()
        nuevo.setFecha_nac(caja_fecha_nac.getText());
        nuevo.setCorreo(caja_correo.getText());
        UsuarioDAO.insertarUsuario(nuevo);
        ventana_crear_usuario.setVisible(false);
        resetearAgregar();
    }//GEN-LAST:event_boton_agregarActionPerformed

    private void caja_correoMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_caja_correoMousePressed
        if (caja_correo.getText().equals("p.ej: ejemplo@ejemplo.com")) {
            caja_correo.setText("");
            caja_correo.setForeground(new java.awt.Color(38, 38, 38));
        }
    }//GEN-LAST:event_caja_correoMousePressed

    private void modificar_passwordActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_modificar_passwordActionPerformed
        mostrarVentanaModifPassword();
    }//GEN-LAST:event_modificar_passwordActionPerformed

    
    private void mostrarVentanaModifPassword() {
        ventana_cambiar_password.setSize(330, 330);
        texto_password.setText("Modificar contraseña del usuario ");
        ventana_cambiar_password.setLocationRelativeTo(null);
        ventana_cambiar_password.setVisible(true);
    }

    private void actualizar_passwordActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_actualizar_passwordActionPerformed
        Usuario modificar = login.seleccionarUsuario(caja_username.getText());

        String passwd_antigua = String.valueOf(caja_antigua.getPassword());
        String passwd_nueva = String.valueOf(caja_nueva.getPassword());
        String passwd_nueva_confirmada = String.valueOf(caja_confirmar.getPassword());

        Boolean passwd_antigua_correcta = passwd_antigua.equals(modificar.getPassword());
        Boolean passwd_nueva_coincide = passwd_nueva.equals(passwd_nueva_confirmada);

        if (!passwd_antigua_correcta) {
            JOptionPane.showMessageDialog(null, "La contraseña actual introducida no es correcta.", "Contraseña incorrecta", JOptionPane.WARNING_MESSAGE);
            return;
        }

        if (!passwd_nueva_coincide) {
            caja_nueva.setBackground(Color.red);
            caja_confirmar.setBackground(Color.red);
            return;
        }

        if (passwd_antigua.equals(passwd_nueva)) {
            JOptionPane.showMessageDialog(null, "La contraseña nueva no puede coincidir con la actual", "Contraseña identica", JOptionPane.WARNING_MESSAGE);
            return;
        }
        if(passwd_nueva.isBlank() || passwd_nueva_confirmada.isBlank() || passwd_antigua.isBlank() ){
            JOptionPane.showMessageDialog(null, "Rellene todos los campos", "Campos vacíos", JOptionPane.WARNING_MESSAGE);
            return;
        }

        modificar.setPassword(passwd_nueva);
        UsuarioDAO.modificarPasswordUsuario(modificar);
        JOptionPane.showMessageDialog(null, "Contraseña actualizada exitosamente", "Contraseña actualizada", JOptionPane.WARNING_MESSAGE);
        ventana_cambiar_password.setVisible(false);
    }//GEN-LAST:event_actualizar_passwordActionPerformed

    private void caja_nuevaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_caja_nuevaActionPerformed

    }//GEN-LAST:event_caja_nuevaActionPerformed

    private void caja_nuevaMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_caja_nuevaMousePressed
        caja_nueva.setBackground(Color.white);
        caja_confirmar.setBackground(Color.white);
    }//GEN-LAST:event_caja_nuevaMousePressed

    private void caja_confirmarMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_caja_confirmarMousePressed
        caja_nueva.setBackground(Color.white);
        caja_confirmar.setBackground(Color.white);
    }//GEN-LAST:event_caja_confirmarMousePressed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(Ventana_practica2_6.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(Ventana_practica2_6.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(Ventana_practica2_6.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(Ventana_practica2_6.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new Ventana_practica2_6().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton actualizar_password;
    private javax.swing.JLabel bienvenido;
    private javax.swing.JButton boton_agregar;
    private javax.swing.JButton boton_loggear;
    private javax.swing.JButton boton_nuevo_usuario_log;
    private javax.swing.JButton boton_volver;
    private javax.swing.JPasswordField caja_antigua;
    private javax.swing.JTextField caja_apellido;
    private javax.swing.JPasswordField caja_confirmar;
    private javax.swing.JTextField caja_contrasena_crear;
    private javax.swing.JTextField caja_contrasena_crear_2;
    private javax.swing.JTextField caja_correo;
    private javax.swing.JTextField caja_fecha_nac;
    private javax.swing.JTextField caja_nombre;
    private javax.swing.JPasswordField caja_nueva;
    private javax.swing.JPasswordField caja_password;
    private javax.swing.JTextField caja_username;
    private javax.swing.JTextField caja_username_crear;
    private com.toedter.calendar.JDateChooser calendario;
    private javax.swing.JButton cerrar_sesion;
    private javax.swing.JLabel crear_cuenta;
    private javax.swing.JLabel eiqueta_usuario;
    private javax.swing.JLabel etiqueta_antigua;
    private javax.swing.JLabel etiqueta_apellido;
    private javax.swing.JLabel etiqueta_confirmar;
    private javax.swing.JLabel etiqueta_contrasena;
    private javax.swing.JLabel etiqueta_contrasena_crear_usuario;
    private javax.swing.JLabel etiqueta_contrasena_crear_usuario2;
    private javax.swing.JLabel etiqueta_correo;
    private javax.swing.JLabel etiqueta_fecha_nac;
    private javax.swing.JLabel etiqueta_instrucciones;
    private javax.swing.JLabel etiqueta_nombre;
    private javax.swing.JLabel etiqueta_nueva;
    private javax.swing.JLabel etiqueta_usuario;
    private javax.swing.JLabel icono;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JSeparator jSeparator1;
    private javax.swing.JButton modificar_password;
    private javax.swing.JLabel msg_bienvenida;
    private javax.swing.JLabel msg_incorrecta;
    private javax.swing.JCheckBox opcion_mostrar;
    private javax.swing.JPanel panel_loggin;
    private javax.swing.JLabel texto_password;
    private javax.swing.JFrame ventana_cambiar_password;
    private javax.swing.JFrame ventana_crear_usuario;
    private javax.swing.JFrame ventana_log_correcto;
    // End of variables declaration//GEN-END:variables
}
